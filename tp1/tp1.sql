/*
    Question 3 :
    ------------
*/
-- Compter le nombre total d'ahtletes. 

-- SELECT count( DISTINCT code ) AS nb_athletes FROM Athlete;


/*
    Question 4 :
    ------------
*/
-- Afficher les épreuves ayant lieu le 29 juillet 2021

-- SELECT * 
-- FROM Epreuve 
-- WHERE dateE='2021-07-29'::date;


/*
    Question 5 :
    ------------
*/
-- Afficher les noms de disciplines ayant une épreuve le 29 juillet 2021 

-- SELECT DISTINCT d.nom 
-- FROM Discipline d, Epreuve e
-- WHERE e.dateE='2021-07-29'::date;

/*
    Question 6 :
    ------------
*/
-- Afficher les athletes français par ordre alphabétique. 

-- SELECT nom, prenom, dateNaiss
-- FROM Athlete
-- WHERE pays LIKE 'FRA'
-- ORDER BY nom, prenom;


/*
    Question 7 :
    ------------
*/
-- Combien de médailles ont été remportées par Kathleen LEDECKY ?

-- SELECT count(*)
-- FROM Resultat r, Athlete a 
-- WHERE r.athlete=a.code
--     AND a.nom='LEDECKY'
--     AND a.prenom='Kathleen';


/*
    Question 8 :
    ------------
*/
-- Trouver la vainqueure de l'épreuve E059 ainsi que le nom de l'épreuve et de la discipline correspondante. 

-- SELECT 
--	a.nom AS nom_athlete,
--       	a.prenom AS prenom_athlete,
--       	a.pays AS pays_athlete, 
--	e.nom AS nom_epreuve,
--	d.nom AS nom_discipline

--FROM
--	Discipline d,
--	Athlete a,
--	Resultat r,
--	Medaille m,
--	Epreuve e

--WHERE
--	r.epreuve = e.code
--	AND r.athlete = a.code
--	AND e.discipl = d.code
--	AND r.medaille = m.place
--	AND m.place   = 1
--	AND a.sexe = 'F'
--        AND e.code = 'E059';


/*
	Question 9 :
	------------
*/
-- Qui est le ou la athlete le plus jeune, parmis ceux dont on connait la date de naissance ?

--SELECT
--	a.nom AS nom_athlete,
--       	a.prenom AS prenom_athlete,
--	a.dateNaiss AS date_naissance


--FROM
--	Athlete a

--WHERE
--	a.dateNaiss = ( SELECT Max(dateNaiss) FROM Athlete);

-- Par défaut les fonctions d'agrégation comme MAX font leurs calculs sur l'ensemble de la table, d'où le fait que je n'ai pas eu besoin d'utiliser de GROUP BY.




/* 
	Question 10 :
	-------------
*/
-- Qui est l'athlete le ou la plus âgée et quel était son âge à l'ouverture des jeux ( le 23 Juillet 2021 ) ?

--SELECT 
--	a.nom,
--	a.prenom,
--	a.pays,
--	a.dateNaiss,
--	extract( year from '2021/07/23'::date) - extract( year from a.datenaiss::date ) AS age_debut_jeux

--FROM
--	Athlete a

--WHERE 
--	a.dateNaiss = ( SELECT MIN(dateNaiss) FROM Athlete);



/*
	Question 11 :
	-------------
*/
-- Lister les pays dont le nom commence par A et qui n'ont remporté aucune médaille.

SELECT 
	p.nom

FROM 
	Pays p,
	Athlete a

WHERE 
	a.pays = p.code
	AND NOT EXISTS ( SELECT
					a.nom,
					a.pays,
					m.place,
					m.couleur

				FROM 
					Resultat r,
					Athlete a,
					Medaille m

				WHERE
					r.athlete = a.code
					AND r.medaille = m.place);






	


