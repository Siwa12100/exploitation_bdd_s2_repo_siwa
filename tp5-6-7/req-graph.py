import pandas as pd
import psycopg2 as psy

co = None


try :
    co = psy.connect(host = 'londres',
                    database = 'dbjemarcilla',
                    user = 'jemarcilla',
                    password = "achanger")


    data = pd.read_sql('''SELECT * FROM JeuxVideos;''', con = co)

    curs = co.cursor()


# Recherche des valeurs Global Sales incohérentes :
# -------------------------------------------------
    # curs.execute( '''SELECT
    #                     jv.Name,
    #                     jv.Platform,
    #                     jv.Year,
    #                     jv.Publisher,
    #                     jv.Global_Sales
    #             FROM
    #                     JeuxVideos jv
    #             WHERE 
    #                 ( jv.NA_Sales + jv.EU_Sales + JP_Sales + Other_Sales ) != jv.Global_Sales;
    #               ''')


# Mise à jour des valeurs de ventes globales incohérentes :
# ---------------------------------------------------------
    # curs.execute('''UPDATE
    #                         JeuxVideos jv
    #                 SET
    #                         Global_Sales = ( jv.NA_Sales + jv.EU_Sales + JP_Sales + Other_Sales )
    #                 WHERE
    #                         ( jv.NA_Sales + jv.EU_Sales + JP_Sales + Other_Sales ) != jv.Global_Sales;
    #             ''')



# Mise a jour et creation du Dataframe :
# --------------------------------------
    data = pd.read_sql('''SELECT * FROM JeuxVideos;''', con = co)
    df = pd.DataFrame(data)



# Calcul des ventes moyennes par année de sortie des jeux ( pour les jeux du genre "Adventure") :
# -----------------------------------------------------------------------------------------------
curs.execute('''
                    
            ''')



# Affichage et fermeture du curseur et de la lecture :
# ----------------------------------------------------
    res = curs.fetchall()
    print(res)
    
    co.commit()
    curs.close()

except( Exception, psy.DatabaseError ) as error :
    print( error )

finally :
    if co is not None :
        co.close()


