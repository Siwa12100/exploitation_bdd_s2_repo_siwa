
/* Question 1 :
--------------- */
-- SELECT Discipline.nom,
-- 	COUNT ( CASE WHEN EXTRACT(MONTH FROM Epreuve.dateE) = 7 THEN 1 END ) as nb_juillet,
-- 	COUNT ( CASE WHEN EXTRACT(MONTH FROM Epreuve.dateE) = 8 THEN 1 END ) as nb_aout
-- FROM Epreuve, Discipline
-- WHERE Epreuve.discipl = Discipline.code
-- GROUP BY Discipline.nom 
-- HAVING COUNT( CASE WHEN EXTRACT(MONTH FROM Epreuve.dateE) = 7 THEN 1 END ) > COUNT( CASE WHEN EXTRACT(MONTH FROM Epreuve.dateE) = 8 THEN 1 END );



/* Question 2 :
--------------- */


-- SELECT paysNaiss,
   --     count(DISTINCT Athlete.code) as nb_athletes,
   --     count(DISTINCT Resultat.athlete) as nb_medailles
-- FROM Athlete
-- LEFT JOIN Resultat ON Athlete.code = Resultat.athlete
-- GROUP BY paysNaiss
-- HAVING count(DISTINCT Resultat.athlete) >= 0.5 * count(DISTINCT Athlete.code);



/* Question 3 :
--------------*/

SELECT Pays.nom,
       (SELECT COUNT(*)
        FROM Athlete
        JOIN Resultat ON Athlete.code = Resultat.athlete
        JOIN Medaille ON Resultat.medaille = Medaille.place
        WHERE Medaille.couleur = 'Or' AND Athlete.pays = Pays.code)
       AS nb_or,
       (SELECT COUNT(*)
        FROM Athlete
        JOIN Resultat ON Athlete.code = Resultat.athlete
        JOIN Medaille ON Resultat.medaille = Medaille.place
        WHERE Medaille.couleur != 'Or' AND Athlete.pays = Pays.code)
       AS nb_argent_bronze
FROM Pays
HAVING nb_or > nb_argent_bronze;

