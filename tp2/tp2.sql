/*
    TP 2 SQL
    --------
*/


/*
    Question 1 :
    ------------
*/
--  SELECT p.nom AS nom_pays, count( * ) nb_athletes
--  FROM Pays p, Athlete a
--  Where p.code = a.pays
--  GROUP BY p.nom;


/*
    Question 2 :
    ------------
*/
--  SELECT d.nom AS Nom_Discipline, count( e.nom ) AS Nb_epreuves
--  FROM Discipline d, Epreuve e
--  WHERE d.code = e.discipl
--  GROUP BY d.nom;


/* 
    Question 3 :
    ------------
*/
-- SELECT d.nom, MAX(e.dateE) Derniere_epreuve
-- FROM Epreuve e, Discipline d 
-- WHERE d.code = e.discipl
-- GROUP BY d.nom;


/*
    Question 4 :
    ------------
*/

-- SELECT d.nom AS Nom_Discipline, a.nom AS nom_athlete, a.sexe, a.dateNaiss
-- FROM Discipline d, Athlete a, Pratiquer p 
-- WHERE p.discipl = d.code AND p.athlete = a.code
-- ORDER BY d.nom;


-- SELECT d.nom, MAX( a.dateNaiss)
-- FROM Athlete a, Discipline d, Pratiquer p 
-- WHERE p.athlete = a.code AND p.discipl = d.code
-- AND a.sexe LIKE 'F'
-- GROUP BY d.nom;


SELECT d.nom AS nom_discipline, a.nom AS nom_athlete, 
       a.sexe AS sexe_athlete,
       a.dateNaiss AS date_naissance_athlete
       
FROM Athlete a, Discipline d, Pratiquer p 
WHERE a.code = p.athlete
AND d.code = p.discipl
GROUP BY d.nom, a.nom, a.sexe, a.dateNaiss;
ORDER BY d.sexe;

-- SELECT d.nom, MAX( a.dateNaiss)
-- FROM Athlete a, Discipline d, Pratiquer p 
-- WHERE p.athlete = a.code AND p.discipl = d.code
-- AND a.sexe LIKE 'M'
-- GROUP BY d.nom;

-- SELECT d.nom AS Nom_Discipline, a.nom AS nom_athlete, a.sexe AS sexe_athlete

--         ( SELECT d.nom, MAX( a.dateNaiss)
--             FROM Athlete a, Discipline d, Pratiquer p 
--             WHERE p.athlete = a.code AND p.discipl = d.code
--             AND a.sexe LIKE 'M'
--             GROUP BY d.nom;) AS date_naissance_homme, 

--         ( SELECT d.nom, MAX( a.dateNaiss)
--         FROM Athlete a, Discipline d, Pratiquer p 
--         WHERE p.athlete = a.code AND p.discipl = d.code
--         AND a.sexe LIKE 'M'
--         GROUP BY d.nom; ) AS date_naissance_femme;

        



    
